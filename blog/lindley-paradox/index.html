<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="default-src 'self';font-src 'self' data:;img-src 'self' https://* data:;media-src 'self';style-src 'self';frame-src player.vimeo.com https://www.youtube-nocookie.com https://www.youtube.com;connect-src 'self';script-src 'self' 'self'" http-equiv=Content-Security-Policy><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://storopoli.com name=base><title>
Jose Storopoli, PhD • Lindley's paradox, or the consistency of Bayesian thinking</title><link href=https://storopoli.com/favicon.svg rel=icon type=image/png><link title="Jose Storopoli, PhD - Atom Feed" href=https://storopoli.com/atom.xml rel=alternate type=application/atom+xml><link href="https://storopoli.com/custom_subset.css?h=0b9535a28bc3d5bf2321" rel=stylesheet><link href="https://storopoli.com/main.css?h=6b1dda977391dad0c76e" rel=stylesheet><link href="https://storopoli.com/extra.css?h=33c2dfb527f758787862" rel=stylesheet><link href="https://storopoli.com/skins/teal.css?h=bd19e558a52d678a50de" rel=stylesheet><meta content="light dark" name=color-scheme><meta content="Personal website of Jose Storopoli, PhD" name=description><meta content="Personal website of Jose Storopoli, PhD" property=og:description><meta content="Lindley's paradox, or the consistency of Bayesian thinking" property=og:title><meta content=article property=og:type><meta content=en_GB property=og:locale><meta content=https://storopoli.com/blog/lindley-paradox/ property=og:url><meta content="Jose Storopoli, PhD" property=og:site_name><noscript><link href=https://storopoli.com/no_js.css rel=stylesheet></noscript><script src=https://storopoli.com/js/initializeTheme.min.js></script><script defer src=https://storopoli.com/js/themeSwitcher.min.js></script><body><header><nav class=navbar><div class=nav-title><a class=home-title href=https://storopoli.com>Jose Storopoli, PhD</a></div><div class=nav-navs><ul><li><a class="nav-links no-hover-padding" href=https://storopoli.com/blog/>blog </a><li><a class="nav-links no-hover-padding" href=https://storopoli.com/tags/>tags </a><li class=menu-icons-container><ul class=menu-icons-group><li class="theme-switcher-wrapper js"><div aria-label="Toggle dark mode" title="Toggle dark/light mode" aria-pressed=false class=theme-switcher role=button tabindex=0></div><div aria-label="Reset mode to default" class="theme-resetter arrow" title="Reset mode to default" aria-hidden=true role=button tabindex=0></div></ul></ul></div></nav></header><div class=content><main><article><h1 class=article-title>Lindley’s paradox, or the consistency of Bayesian thinking</h1><ul class=meta><span class="hidden p-author h-card"> <a title="Jose Storopoli, PhD" class=u-url href=https://storopoli.com rel=author>Jose Storopoli, PhD</a> </span><li>22nd Nov 2023<li title="1466 words"><span aria-hidden=true class=separator>•</span>8 min read<li class=tag><span aria-hidden=true class=separator>•</span>Tags: <li class=tag><a href=https://storopoli.com/tags/math/>math</a>, <li class=tag><a href=https://storopoli.com/tags/bayesian/>bayesian</a>, <li class=tag><a href=https://storopoli.com/tags/probability/>probability</a>, <li class=tag><a href=https://storopoli.com/tags/julia/>julia</a></ul><div class=toc-container><h3>Table of Contents</h3><ul><li><a href=https://storopoli.com/blog/lindley-paradox/#lindley-s-paradox>Lindley’s Paradox</a><li><a href=https://storopoli.com/blog/lindley-paradox/#example>Example</a> <ul><li><a href=https://storopoli.com/blog/lindley-paradox/#analytical-solution>Analytical Solution</a> <ul><li><a href=https://storopoli.com/blog/lindley-paradox/#analytical-solutions-frequentist-approach>Analytical Solutions – Frequentist Approach</a><li><a href=https://storopoli.com/blog/lindley-paradox/#analytical-solutions-bayesian-approach>Analytical Solutions – Bayesian Approach</a></ul><li><a href=https://storopoli.com/blog/lindley-paradox/#computational-solutional>Computational Solutional</a> <ul><li><a href=https://storopoli.com/blog/lindley-paradox/#computational-solutions-frequentist-approach>Computational Solutions – Frequentist Approach</a><li><a href=https://storopoli.com/blog/lindley-paradox/#computational-solutions-bayesian-approach>Computational Solutions – Bayesian Approach</a></ul></ul><li><a href=https://storopoli.com/blog/lindley-paradox/#why-the-frequentist-and-bayesian-approaches-disagree>Why the Frequentist and Bayesian Approaches Disagree</a><li><a href=https://storopoli.com/blog/lindley-paradox/#references>References</a></ul></div><section class=body><noscript><div class="admonition warning"><div class="admonition-icon admonition-icon-warning"></div><div class=admonition-content><strong class=admonition-title> Evil JavaScript </strong><p>This post uses <a href=https://katex.org/>KaTeX</a> to render mathematical expressions.<p>To see the rendered mathematical expressions, you’ll need to enable JavaScript.</div></div></noscript><p><img alt="Dennis Lindley" src=https://storopoli.com/blog/lindley-paradox/lindley.jpg><p><a href=https://en.wikipedia.org/wiki/Dennis_Lindley>Dennis Lindley</a>, one of my many heroes, was an English statistician, decision theorist and leading advocate of Bayesian statistics. He published a pivotal book, <a href=https://onlinelibrary.wiley.com/doi/book/10.1002/9781118650158>Understanding Uncertainty</a>, that changed my view on what is and how to handle uncertainty in a coherent way. He is responsible for one of my favorites quotes: “Inside every non-Bayesian there is a Bayesian struggling to get out”; and one of my favorite heuristics around prior probabilities: <a href=https://en.wikipedia.org/wiki/Cromwell%27s_rule>Cromwell’s Rule</a>. Lindley predicted in 1975 that “Bayesian methods will indeed become pervasive, enabled by the development of powerful computing facilities” (Lindley, 1975). You can find more about all of Lindley’s achievements in his <a href=https://www.theguardian.com/science/2014/mar/16/dennis-lindley>obituary</a>.<h2 id=lindley-s-paradox>Lindley’s Paradox</h2><p>Lindley’s paradox is a counterintuitive situation in statistics in which the Bayesian and frequentist approaches to a hypothesis testing problem give different results for certain choices of the prior distribution.<p>More formally, the paradox is as follows. We have some parameter $\theta$ that we are interested in. Then, we proceed with an experiment to test two competing hypotheses:<ol><li>$H_0$ (also known as <em>null hypothesis</em>): there is no “effect”, or, more specifically, $\theta = 0$.<li>$H_a$ (also known as <em>alternative hypothesis</em>): there is an “effect”, or, more specifically, $\theta \ne 0$.</ol><p>The paradox occurs when two conditions are met:<ol><li>The result of the experiment is <em>significant</em> by a frequentist test of $H_0$, which indicates sufficient evidence to reject $H_0$, at a certain threshold of probability.<li>The posterior probability (Bayesian approach) of $H_0 \mid \theta$ (null hypothesis given $\theta$) is high, which indicates strong evidence that $H_0$ should be favored over $H_a$, that is, to <em>not</em> reject $H_0$.</ol><p>These results can occur at the same time when $H_0$ is very specific, $H_a$ more diffuse, and the prior distribution does not strongly favor one or the other. These conditions are pervasive across science and common in traditional null-hypothesis significance testing approaches.<p>This is a duel of frequentist versus Bayesian approaches, and one of the many in which Bayesian emerges as the most coherent. Let’s give a example and go over the analytical result with a ton of math, but also a computational result with <a href=https://julialang.org>Julia</a>.<h2 id=example>Example</h2><p>Here’s the setup for the example. In a certain city 49,581 boys and 48,870 girls have been born over a certain time period. The observed proportion of male births is thus $\frac{49,581}{98,451} \approx 0.5036$.<p>We assume that the birth of a child is independent with a certain probability $\theta$. Since our data is a sequence of $n$ independent <a href=https://en.wikipedia.org/wiki/Bernoulli_trial>Bernoulli trials</a>, i.e., $n$ independent random experiments with exactly two possible outcomes: “success” and “failure”, in which the probability of success is the same every time the experiment is conducted. We can safely assume that it follows a <a href=https://en.wikipedia.org/wiki/Binomial_distribution>binomial distribution</a> with parameters:<ul><li>$n$: the number of “trials” (or the total number of births).<li>$\theta$: the probability of male births.</ul><p>We then set up our two competing hypotheses:<ol><li>$H_0$: $\theta = 0.5$.<li>$H_a$: $\theta \ne 0.5$.</ol><h3 id=analytical-solution>Analytical Solution</h3><p>This is a toy-problem and, like most toy problems, we can solve it analytically for both the frequentist and the Bayesian approaches.<h4 id=analytical-solutions-frequentist-approach>Analytical Solutions – Frequentist Approach</h4><p>The frequentist approach to testing $H_0$ is to compute a $p$-value, the probability of observing births of boys at least as large as 49,581 assuming $H_0$ is true. Because the number of births is very large, we can use a normal approximation for the binomial-distributed number of male births. Let’s define $X$ as the total number of male births, then $X$ follows a normal distribution:<p>$$X \sim \text{Normal}(\mu, \sigma)$$<p>where $\mu$ is the mean parameter, $n \theta$ in our case, and $\sigma$ is the standard deviation parameter, $\sqrt{n \theta (1 - \theta)}$. We need to calculate the conditional probability of $X \geq \frac{49,581}{98,451} \approx 0.5036$ given $\mu = n \theta = 98,451 \cdot \frac{1}{2} = 49,225.5$ and<p>$\sigma = \sqrt{n \theta (1 - \theta)} = \sqrt{98,451 \cdot \frac{1}{2} \cdot (1 - \frac{1}{2})}$:<p>$$P(X \ge 0.5036 \mid \mu = 49,225.5, \sigma = \sqrt{24.612.75})$$<p>This is basically a <a href=https://en.wikipedia.org/wiki/Cumulative_distribution_function>cumulative distribution function (CDF)</a> of $X$ on the interval $[49,225.5; 98,451]$:<p>$$ \int_{49,225.5}^{98,451} \frac{1}{\sqrt{2 \pi \sigma^2}} e^{- \frac{\left( \frac{x - \mu}{\sigma} \right)^2}{2}} dx $$<p>After inserting the values and doing some arithmetic, our answer is approximately $0.0117$. Note that this is a one-sided test, since it is symmetrical, the two-sided test would be $0.0117 \cdot 2 = 0.0235$. Since we don’t deviate from the Fisher’s canon, this is well below the 5% threshold. Hooray! We rejected the null hypothesis! Quick! Grab a frequentist celebratory cigar! But, wait. Let’s check the Bayesian approach.<h4 id=analytical-solutions-bayesian-approach>Analytical Solutions – Bayesian Approach</h4><p>For the Bayesian approach, we need to set prior probabilities on both hypotheses. Since we do not favor one from another, let’s set equal prior probabilities:<p>$$P(H_0) = P(H_a) = \frac{1}{2}$$<p>Additionally, all parameters of interest need a prior distribution. So, let’s put a prior distribution on $\theta$. We could be fancy here, but let’s not. We’ll use a uniform distribution on $[0, 1]$.<p>We have everything we need to compute the posterior probability of $H_0$ given $\theta$. For this, we’ll use <a href=https://en.wikipedia.org/wiki/Bayes%27_theorem>Bayes theorem</a>:<p>$$P(A \mid B) = \frac{P(B \mid A) P(A)}{P(B)}$$<p>Now again let’s plug in all the values:<p>$$P(H_0 \mid \theta) = \frac{P(\theta \mid H_0) P(H_0)}{P(\theta)}$$<p>Note that by the <a href=https://en.wikipedia.org/wiki/Probability_axioms>axioms of probability</a> and by the <a href=https://en.wikipedia.org/wiki/Chain_rule_(probability)>product rule of probability</a> we can decompose $P(\theta)$ into:<p>$$P(\theta) = P(\theta \mid H_0) P(H_0) + P(\theta \mid H_a) P(H_a)$$<p>Again, we’ll use the normal approximation:<p>$$ \begin{aligned} &P \left( \theta = 0.5 \mid \mu = 49,225.5, \sigma = \sqrt{24.612.75} \right) \\ &= \frac{ \frac{1}{ \sqrt{2 \pi \sigma^2} } e^{- \left( \frac{(\mu - \mu \cdot 0.5)}{2 \sigma} \right)^2} \cdot 0.5 } { \frac{1}{\sqrt{2 \pi \sigma^2}} e^{ \left( -\frac{(\mu - \mu \cdot 0.5)}{2 \sigma} \right)^2} \cdot 0.5 + \int_0^1 \frac {1}{\sqrt{2 \pi \sigma^2} } e^{- \left( \frac{\mu - \mu \cdot \theta)}{2 \sigma} \right)^2} d \theta \cdot 0.5 } \\ &= 0.9505 \end{aligned} $$<p>The likelihood of the alternative hypothesis, $P(\theta \mid H_a)$, is just the CDF of all possible values of $\theta \ne 0.5$.<p>$$ P(H_0 \mid \text{data}) = P \left( \theta = 0.5 \mid \mu = 49,225.5, sigma = \sqrt{24.612.75} \right) > 0.95 $$<p>And we fail to reject the null hypothesis, in frequentist terms. However, we can also say in Bayesian terms, that we strongly favor $H_0$ over $H_a$.<p>Quick! Grab the Bayesian celebratory cigar! The null is back on the game!<h3 id=computational-solutional>Computational Solutional</h3><p>For the computational solution, we’ll use <a href=https://julialang.org>Julia</a> and the following packages:<ul><li><a href=https://github.com/JuliaStats/HypothesisTests.jl><code>HypothesisTest.jl</code></a><li><a href=https://turinglang.org/><code>Turing.jl</code></a></ul><h4 id=computational-solutions-frequentist-approach>Computational Solutions – Frequentist Approach</h4><p>We can perform a <a href=https://juliastats.org/HypothesisTests.jl/stable/nonparametric/#Binomial-test><code>BinomialTest</code></a> with <code>HypothesisTest.jl</code>:<pre class="language-julia z-code" data-lang=julia><code class=language-julia data-lang=julia><span class="z-source z-julia">julia<span class="z-keyword z-operator z-julia">></span> <span class="z-keyword z-other z-julia">using</span> HypothesisTests
</span><span class="z-source z-julia">
</span><span class="z-source z-julia">julia<span class="z-keyword z-operator z-julia">></span> BinomialTest<span class="z-meta z-group z-julia"><span class="z-punctuation z-section z-group z-begin z-julia">(</span><span class="z-constant z-numeric z-julia">49_225</span>, <span class="z-constant z-numeric z-julia">98_451</span>, <span class="z-constant z-numeric z-julia">0.5036</span><span class="z-punctuation z-section z-group z-end z-julia">)</span></span>
</span><span class="z-source z-julia">Binomial test
</span><span class="z-source z-julia"><span class="z-keyword z-operator z-julia">-</span><span class="z-keyword z-operator z-julia">-</span><span class="z-keyword z-operator z-julia">-</span><span class="z-keyword z-operator z-julia">-</span><span class="z-keyword z-operator z-julia">-</span><span class="z-keyword z-operator z-julia">-</span><span class="z-keyword z-operator z-julia">-</span><span class="z-keyword z-operator z-julia">-</span><span class="z-keyword z-operator z-julia">-</span><span class="z-keyword z-operator z-julia">-</span><span class="z-keyword z-operator z-julia">-</span><span class="z-keyword z-operator z-julia">-</span><span class="z-keyword z-operator z-julia">-</span>
</span><span class="z-source z-julia">Population details<span class="z-keyword z-operator z-julia">:</span>
</span><span class="z-source z-julia">    parameter of interest<span class="z-keyword z-operator z-julia">:</span>   Probability of success
</span><span class="z-source z-julia">    value under h_<span class="z-constant z-numeric z-julia">0</span><span class="z-keyword z-operator z-colon z-julia">:</span>         <span class="z-constant z-numeric z-julia">0.5036</span>
</span><span class="z-source z-julia">    point estimate<span class="z-keyword z-operator z-julia">:</span>          <span class="z-constant z-numeric z-julia">0.499995</span>
</span><span class="z-source z-julia">    <span class="z-constant z-numeric z-julia">95</span><span class="z-keyword z-operator z-julia">%</span> confidence interval<span class="z-keyword z-operator z-julia">:</span> <span class="z-meta z-group z-julia"><span class="z-punctuation z-section z-group z-begin z-julia">(</span><span class="z-constant z-numeric z-julia">0.4969</span>, <span class="z-constant z-numeric z-julia">0.5031</span><span class="z-punctuation z-section z-group z-end z-julia">)</span></span>
</span><span class="z-source z-julia">
</span><span class="z-source z-julia">Test summary<span class="z-keyword z-operator z-julia">:</span>
</span><span class="z-source z-julia">    outcome with <span class="z-constant z-numeric z-julia">95</span><span class="z-keyword z-operator z-julia">%</span> confidence<span class="z-keyword z-operator z-julia">:</span> reject h_<span class="z-constant z-numeric z-julia">0</span>
</span><span class="z-source z-julia">    two<span class="z-keyword z-operator z-julia">-</span>sided p<span class="z-keyword z-operator z-julia">-</span>value<span class="z-keyword z-operator z-julia">:</span>           <span class="z-constant z-numeric z-julia">0.0239</span>
</span><span class="z-source z-julia">
</span><span class="z-source z-julia">Details<span class="z-keyword z-operator z-julia">:</span>
</span><span class="z-source z-julia">    number of observations<span class="z-keyword z-operator z-julia">:</span> <span class="z-constant z-numeric z-julia">98451</span>
</span><span class="z-source z-julia">    number of successes<span class="z-keyword z-operator z-julia">:</span>    <span class="z-constant z-numeric z-julia">49225</span>
</span></code></pre><p>This is the two-sided test, and I had to round $49,225.5$ to $49,225$ since <code>BinomialTest</code> do not support real numbers. But the results match with the analytical solution, we still reject the null.<h4 id=computational-solutions-bayesian-approach>Computational Solutions – Bayesian Approach</h4><p>Now, for the Bayesian computational approach, I’m going to use a generative modeling approach, and one of my favorites probabilistic programming languages, <code>Turing.jl</code>:<pre class="language-julia z-code" data-lang=julia><code class=language-julia data-lang=julia><span class="z-source z-julia">julia<span class="z-keyword z-operator z-julia">></span> <span class="z-keyword z-other z-julia">using</span> Turing
</span><span class="z-source z-julia">
</span><span class="z-source z-julia">julia<span class="z-keyword z-operator z-julia">></span> <span class="z-meta z-function-call z-macro z-julia"><span class="z-punctuation z-definition z-macro z-julia">@</span><span class="z-variable z-macro z-julia"><span class="z-meta z-generic-name z-julia">model</span></span></span> <span class="z-meta z-function z-julia"><span class="z-keyword z-declaration z-function z-julia">function</span> <span class="z-entity z-name z-function z-julia"><span class="z-meta z-generic-name z-julia">birth_rate</span></span><span class="z-punctuation z-section z-parameters z-end z-julia">(</span><span class="z-meta z-function z-parameters z-julia"><span class="z-punctuation z-section z-parameters z-end z-julia">)</span></span>
</span></span><span class="z-source z-julia"><span class="z-meta z-function z-julia">           θ <span class="z-keyword z-operator z-julia">~</span> Uniform<span class="z-meta z-group z-julia"><span class="z-punctuation z-section z-group z-begin z-julia">(</span><span class="z-constant z-numeric z-julia">0</span>, <span class="z-constant z-numeric z-julia">1</span><span class="z-punctuation z-section z-group z-end z-julia">)</span></span>
</span></span><span class="z-source z-julia"><span class="z-meta z-function z-julia">           total_births <span class="z-keyword z-operator z-assignment z-julia">=</span> <span class="z-constant z-numeric z-julia">98_451</span>
</span></span><span class="z-source z-julia"><span class="z-meta z-function z-julia">           male_births <span class="z-keyword z-operator z-julia">~</span> Binomial<span class="z-meta z-group z-julia"><span class="z-punctuation z-section z-group z-begin z-julia">(</span>total_births, θ<span class="z-punctuation z-section z-group z-end z-julia">)</span></span>
</span></span><span class="z-source z-julia"><span class="z-meta z-function z-julia">       <span class="z-keyword z-other z-julia">end</span></span>;
</span><span class="z-source z-julia">
</span><span class="z-source z-julia">julia<span class="z-keyword z-operator z-julia">></span> model <span class="z-keyword z-operator z-assignment z-julia">=</span> birth_rate<span class="z-meta z-group z-julia"><span class="z-punctuation z-section z-group z-begin z-julia">(</span><span class="z-punctuation z-section z-group z-end z-julia">)</span></span> <span class="z-keyword z-operator z-julia">|</span> <span class="z-meta z-group z-julia"><span class="z-punctuation z-section z-group z-begin z-julia">(</span>; male_births <span class="z-keyword z-operator z-assignment z-julia">=</span> <span class="z-constant z-numeric z-julia">49_225</span><span class="z-punctuation z-section z-group z-end z-julia">)</span></span>;
</span><span class="z-source z-julia">
</span><span class="z-source z-julia">julia<span class="z-keyword z-operator z-julia">></span> chain <span class="z-keyword z-operator z-assignment z-julia">=</span> sample<span class="z-meta z-group z-julia"><span class="z-punctuation z-section z-group z-begin z-julia">(</span>model, NUTS<span class="z-meta z-group z-julia"><span class="z-punctuation z-section z-group z-begin z-julia">(</span><span class="z-constant z-numeric z-julia">1_000</span>, <span class="z-constant z-numeric z-julia">0.8</span><span class="z-punctuation z-section z-group z-end z-julia">)</span></span>, MCMCThreads<span class="z-meta z-group z-julia"><span class="z-punctuation z-section z-group z-begin z-julia">(</span><span class="z-punctuation z-section z-group z-end z-julia">)</span></span>, <span class="z-constant z-numeric z-julia">1_000</span>, <span class="z-constant z-numeric z-julia">4</span><span class="z-punctuation z-section z-group z-end z-julia">)</span></span>
</span><span class="z-source z-julia">Chains MCMC chain <span class="z-meta z-group z-julia"><span class="z-punctuation z-section z-group z-begin z-julia">(</span><span class="z-constant z-numeric z-julia">1000</span><span class="z-keyword z-operator z-julia">×</span><span class="z-constant z-numeric z-julia">13</span><span class="z-keyword z-operator z-julia">×</span><span class="z-constant z-numeric z-julia">4</span> Array{Float<span class="z-constant z-numeric z-julia">64</span>, <span class="z-constant z-numeric z-julia">3</span>}<span class="z-punctuation z-section z-group z-end z-julia">)</span></span><span class="z-keyword z-operator z-colon z-julia">:</span>
</span><span class="z-source z-julia">
</span><span class="z-source z-julia">Iterations        <span class="z-keyword z-operator z-assignment z-julia">=</span> <span class="z-constant z-numeric z-julia">1001</span><span class="z-keyword z-operator z-colon z-julia">:</span><span class="z-constant z-numeric z-julia">1</span><span class="z-keyword z-operator z-colon z-julia">:</span><span class="z-constant z-numeric z-julia">2000</span>
</span><span class="z-source z-julia">Number of chains  <span class="z-keyword z-operator z-assignment z-julia">=</span> <span class="z-constant z-numeric z-julia">4</span>
</span><span class="z-source z-julia">Samples per chain <span class="z-keyword z-operator z-assignment z-julia">=</span> <span class="z-constant z-numeric z-julia">1000</span>
</span><span class="z-source z-julia">Wall duration     <span class="z-keyword z-operator z-assignment z-julia">=</span> <span class="z-constant z-numeric z-julia">0.2</span> seconds
</span><span class="z-source z-julia">Compute duration  <span class="z-keyword z-operator z-assignment z-julia">=</span> <span class="z-constant z-numeric z-julia">0.19</span> seconds
</span><span class="z-source z-julia">parameters        <span class="z-keyword z-operator z-assignment z-julia">=</span> θ
</span><span class="z-source z-julia">internals         <span class="z-keyword z-operator z-assignment z-julia">=</span> lp, n_steps, is_accept, acceptance_rate, log_density, hamiltonian_energy, hamiltonian_energy_error, max_hamiltonian_energy_error, tree_depth, numerical_error, step_size, nom_step_size
</span><span class="z-source z-julia">
</span><span class="z-source z-julia">Summary Statistics
</span><span class="z-source z-julia">  parameters      mean       std      mcse    ess_bulk    ess_tail      rhat   ess_per_sec
</span><span class="z-source z-julia">      Symbol   Float<span class="z-constant z-numeric z-julia">64</span>   Float<span class="z-constant z-numeric z-julia">64</span>   Float<span class="z-constant z-numeric z-julia">64</span>     Float<span class="z-constant z-numeric z-julia">64</span>     Float<span class="z-constant z-numeric z-julia">64</span>   Float<span class="z-constant z-numeric z-julia">64</span>       Float<span class="z-constant z-numeric z-julia">64</span>
</span><span class="z-source z-julia">
</span><span class="z-source z-julia">           θ    <span class="z-constant z-numeric z-julia">0.4999</span>    <span class="z-constant z-numeric z-julia">0.0016</span>    <span class="z-constant z-numeric z-julia">0.0000</span>   <span class="z-constant z-numeric z-julia">1422.2028</span>   <span class="z-constant z-numeric z-julia">2198.1987</span>    <span class="z-constant z-numeric z-julia">1.0057</span>     <span class="z-constant z-numeric z-julia">7368.9267</span>
</span><span class="z-source z-julia">
</span><span class="z-source z-julia">Quantiles
</span><span class="z-source z-julia">  parameters      <span class="z-constant z-numeric z-julia">2.5</span><span class="z-keyword z-operator z-julia">%</span>     <span class="z-constant z-numeric z-julia">25.0</span><span class="z-keyword z-operator z-julia">%</span>     <span class="z-constant z-numeric z-julia">50.0</span><span class="z-keyword z-operator z-julia">%</span>     <span class="z-constant z-numeric z-julia">75.0</span><span class="z-keyword z-operator z-julia">%</span>     <span class="z-constant z-numeric z-julia">97.5</span><span class="z-keyword z-operator z-julia">%</span>
</span><span class="z-source z-julia">      Symbol   Float<span class="z-constant z-numeric z-julia">64</span>   Float<span class="z-constant z-numeric z-julia">64</span>   Float<span class="z-constant z-numeric z-julia">64</span>   Float<span class="z-constant z-numeric z-julia">64</span>   Float<span class="z-constant z-numeric z-julia">64</span>
</span><span class="z-source z-julia">
</span><span class="z-source z-julia">           θ    <span class="z-constant z-numeric z-julia">0.4969</span>    <span class="z-constant z-numeric z-julia">0.4988</span>    <span class="z-constant z-numeric z-julia">0.4999</span>    <span class="z-constant z-numeric z-julia">0.5011</span>    <span class="z-constant z-numeric z-julia">0.5031</span>
</span></code></pre><p>We can see from the output of the quantiles that the 95% quantile for $\theta$ is the interval $(0.4969, 0.5031)$. Although it overlaps zero, that is not the equivalent of a hypothesis test. For that, we’ll use the <a href=https://en.wikipedia.org/wiki/highest_posterior_density_interval>highest posterior density interval (HPDI)</a>, which is defined as “choosing the narrowest interval” that captures a certain posterior density threshold value. In this case, we’ll use a threshold interval of 95%, i.e. an $\alpha = 0.05$:<pre class="language-julia z-code" data-lang=julia><code class=language-julia data-lang=julia><span class="z-source z-julia">julia<span class="z-keyword z-operator z-julia">></span> hpd<span class="z-meta z-group z-julia"><span class="z-punctuation z-section z-group z-begin z-julia">(</span>chain; alpha<span class="z-keyword z-operator z-assignment z-julia">=</span><span class="z-constant z-numeric z-julia">0.05</span><span class="z-punctuation z-section z-group z-end z-julia">)</span></span>
</span><span class="z-source z-julia">HPD
</span><span class="z-source z-julia">  parameters     lower     upper
</span><span class="z-source z-julia">      Symbol   Float<span class="z-constant z-numeric z-julia">64</span>   Float<span class="z-constant z-numeric z-julia">64</span>
</span><span class="z-source z-julia">
</span><span class="z-source z-julia">           θ    <span class="z-constant z-numeric z-julia">0.4970</span>    <span class="z-constant z-numeric z-julia">0.5031</span>
</span></code></pre><p>We see that we fail to reject the null, $\theta = 0.5$ at $\alpha = 0.05$ which is in accordance with the analytical solution.<h2 id=why-the-frequentist-and-bayesian-approaches-disagree>Why the Frequentist and Bayesian Approaches Disagree</h2><p>Why do the approaches disagree? What is going on under the hood?<p>The answer is disappointing. The main problem is that the frequentist approach only allows fixed significance levels with respect to sample size. Whereas the Bayesian approach is consistent and robust to sample size variations.<p>Taken to extreme, in some cases, due to huge sample sizes, the $p$-value is pretty much a <em>proxy</em> for sample size and have little to no utility on hypothesis testing. This is known as $p$-hacking.<h2 id=references>References</h2><div class=references><p>Lindley, Dennis V. “The future of statistics: A Bayesian 21st century”. <em>Advances in Applied Probability</em> 7 (1975): 106-115.</div></section></article></main><div id=button-container><div id=toc-floating-container><input class=toggle id=toc-toggle type=checkbox><label class=overlay for=toc-toggle></label><label title="Toggle Table of Contents" class=button for=toc-toggle id=toc-button><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="M414.82-193.094q-18.044 0-30.497-12.32-12.453-12.319-12.453-30.036t12.453-30.086q12.453-12.37 30.497-12.37h392.767q17.237 0 29.927 12.487 12.69 12.486 12.69 30.203 0 17.716-12.69 29.919t-29.927 12.203H414.82Zm0-244.833q-18.044 0-30.497-12.487Q371.87-462.9 371.87-480.45t12.453-29.92q12.453-12.369 30.497-12.369h392.767q17.237 0 29.927 12.511 12.69 12.512 12.69 29.845 0 17.716-12.69 30.086-12.69 12.37-29.927 12.37H414.82Zm0-245.167q-18.044 0-30.497-12.32t-12.453-30.037q0-17.716 12.453-30.086 12.453-12.369 30.497-12.369h392.767q17.237 0 29.927 12.486 12.69 12.487 12.69 30.203 0 17.717-12.69 29.92-12.69 12.203-29.927 12.203H414.82ZM189.379-156.681q-32.652 0-55.878-22.829t-23.226-55.731q0-32.549 23.15-55.647 23.151-23.097 55.95-23.097 32.799 0 55.313 23.484 22.515 23.484 22.515 56.246 0 32.212-22.861 54.893-22.861 22.681-54.963 22.681Zm0-245.167q-32.652 0-55.878-23.134-23.226-23.135-23.226-55.623 0-32.487 23.467-55.517t56.12-23.03q32.102 0 54.721 23.288 22.62 23.288 22.62 55.775 0 32.488-22.861 55.364-22.861 22.877-54.963 22.877Zm-.82-244.833q-32.224 0-55.254-23.288-23.03-23.289-23.03-55.623 0-32.333 23.271-55.364 23.272-23.03 55.495-23.03 32.224 0 55.193 23.288 22.969 23.289 22.969 55.622 0 32.334-23.21 55.364-23.21 23.031-55.434 23.031Z"/></svg></label><div class=toc-content><div class=toc-container><ul><li><a href=https://storopoli.com/blog/lindley-paradox/#lindley-s-paradox>Lindley’s Paradox</a><li><a href=https://storopoli.com/blog/lindley-paradox/#example>Example</a> <ul><li><a href=https://storopoli.com/blog/lindley-paradox/#analytical-solution>Analytical Solution</a> <ul><li><a href=https://storopoli.com/blog/lindley-paradox/#analytical-solutions-frequentist-approach>Analytical Solutions – Frequentist Approach</a><li><a href=https://storopoli.com/blog/lindley-paradox/#analytical-solutions-bayesian-approach>Analytical Solutions – Bayesian Approach</a></ul><li><a href=https://storopoli.com/blog/lindley-paradox/#computational-solutional>Computational Solutional</a> <ul><li><a href=https://storopoli.com/blog/lindley-paradox/#computational-solutions-frequentist-approach>Computational Solutions – Frequentist Approach</a><li><a href=https://storopoli.com/blog/lindley-paradox/#computational-solutions-bayesian-approach>Computational Solutions – Bayesian Approach</a></ul></ul><li><a href=https://storopoli.com/blog/lindley-paradox/#why-the-frequentist-and-bayesian-approaches-disagree>Why the Frequentist and Bayesian Approaches Disagree</a><li><a href=https://storopoli.com/blog/lindley-paradox/#references>References</a></ul></div></div></div><a title="Go to the top of the page" class=no-hover-padding href=# id=top-button> <svg viewbox="0 0 20 20" fill=currentColor><path d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z"/></svg> </a></div><link href=https://storopoli.com/katex.min.css rel=stylesheet><script defer src=https://storopoli.com/js/katex.min.js></script><span class=hidden id=copy-success> Copied! </span><span class=hidden id=copy-init> Copy code to clipboard </span><script defer src=https://storopoli.com/js/copyCodeToClipboard.min.js></script></div><footer><section><nav class="socials nav-navs"><ul><li><a class="nav-links no-hover-padding social" href=https://storopoli.com/atom.xml> <img alt=feed loading=lazy src=https://storopoli.com/social_icons/rss.svg title=feed> </a><li><a class="nav-links no-hover-padding social" rel=" me" href=mailto:jose@storopoli.com> <img alt=email loading=lazy src=https://storopoli.com/social_icons/email.svg title=email> </a><li><a class="nav-links no-hover-padding social" rel=" me" href=https://storopoli.com/publickey.txt> <img alt=pgp loading=lazy src=https://storopoli.com/social_icons/key.svg title=pgp> </a><li><a class="nav-links no-hover-padding social" rel=" me" href=https://github.com/storopoli/> <img alt=github loading=lazy src=https://storopoli.com/social_icons/github.svg title=github> </a><li><a class="nav-links no-hover-padding social" rel=" me" href=https://matrix.to/#/@jose:storopoli.com> <img alt=matrix loading=lazy src=https://storopoli.com/social_icons/matrix.svg title=matrix> </a><li><a class="nav-links no-hover-padding social" href="https://simplex.chat/contact#/?v=2-5&smp=smp%3A%2F%2FUkMFNAXLXeAAe0beCa4w6X_zp18PwxSaSjY17BKUGXQ%3D%40smp12.simplex.im%2FUXrwU_eqdgeHQ6HYehFs0s8VRHOr3k47%23%2F%3Fv%3D1-2%26dh%3DMCowBQYDK2VuAyEApVAYxmE0bpIIiPftNjehy4qOoa14ubyEGzbRX_BlO0w%253D%26srv%3Die42b5weq7zdkghocs3mgxdjeuycheeqqmksntj57rmejagmg4eor5yd.onion" rel=" me"> <img alt=simplex loading=lazy src=https://storopoli.com/social_icons/simplex.svg title=simplex> </a><li><a class="nav-links no-hover-padding social" rel=" me" href=https://orcid.org/0000-0002-0559-5176> <img alt=orcid loading=lazy src=https://storopoli.com/social_icons/orcid.svg title=orcid> </a></ul></nav><nav class=nav-navs></nav><div class=credits><small> Powered by <a href=https://www.getzola.org>Zola</a> & <a href=https://github.com/welpo/tabi>tabi</a> • <a href=https://github.com/storopoli/storopoli.com> Site source </a></small></div></section></footer>