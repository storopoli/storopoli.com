<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="default-src 'self';font-src 'self' data:;img-src 'self' https://* data:;media-src 'self';style-src 'self';frame-src player.vimeo.com https://www.youtube-nocookie.com https://www.youtube.com;connect-src 'self';script-src 'self' 'self'" http-equiv=Content-Security-Policy><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://storopoli.com name=base><title>
Jose Storopoli, PhD • Word embeddings</title><link href=https://storopoli.com/favicon.svg rel=icon type=image/png><link title="Jose Storopoli, PhD - Atom Feed" href=https://storopoli.com/atom.xml rel=alternate type=application/atom+xml><link href="https://storopoli.com/custom_subset.css?h=0b9535a28bc3d5bf2321" rel=stylesheet><link href="https://storopoli.com/main.css?h=6b1dda977391dad0c76e" rel=stylesheet><link href="https://storopoli.com/extra.css?h=33c2dfb527f758787862" rel=stylesheet><link href="https://storopoli.com/skins/teal.css?h=bd19e558a52d678a50de" rel=stylesheet><meta content="light dark" name=color-scheme><meta content="Personal website of Jose Storopoli, PhD" name=description><meta content="Personal website of Jose Storopoli, PhD" property=og:description><meta content="Word embeddings" property=og:title><meta content=article property=og:type><meta content=en_GB property=og:locale><meta content=https://storopoli.com/blog/word-embeddings/ property=og:url><meta content="Jose Storopoli, PhD" property=og:site_name><noscript><link href=https://storopoli.com/no_js.css rel=stylesheet></noscript><script src=https://storopoli.com/js/initializeTheme.min.js></script><script defer src=https://storopoli.com/js/themeSwitcher.min.js></script><body><header><nav class=navbar><div class=nav-title><a class=home-title href=https://storopoli.com>Jose Storopoli, PhD</a></div><div class=nav-navs><ul><li><a class="nav-links no-hover-padding" href=https://storopoli.com/blog/>blog </a><li><a class="nav-links no-hover-padding" href=https://storopoli.com/tags/>tags </a><li class=menu-icons-container><ul class=menu-icons-group><li class="theme-switcher-wrapper js"><div aria-label="Toggle dark mode" title="Toggle dark/light mode" aria-pressed=false class=theme-switcher role=button tabindex=0></div><div aria-label="Reset mode to default" class="theme-resetter arrow" title="Reset mode to default" aria-hidden=true role=button tabindex=0></div></ul></ul></div></nav></header><div class=content><main><article><h1 class=article-title>Word embeddings</h1><ul class=meta><span class="hidden p-author h-card"> <a title="Jose Storopoli, PhD" class=u-url href=https://storopoli.com rel=author>Jose Storopoli, PhD</a> </span><li>19th Nov 2023<li title="945 words"><span aria-hidden=true class=separator>•</span>5 min read<li class=tag><span aria-hidden=true class=separator>•</span>Tags: <li class=tag><a href=https://storopoli.com/tags/math/>math</a>, <li class=tag><a href=https://storopoli.com/tags/machine-learning/>machine learning</a>, <li class=tag><a href=https://storopoli.com/tags/julia/>julia</a></ul><div class=toc-container><h3>Table of Contents</h3><ul><li><a href=https://storopoli.com/blog/word-embeddings/#word-embeddings>Word Embeddings</a><li><a href=https://storopoli.com/blog/word-embeddings/#pre-trained-word-embeddings>Pre-Trained Word Embeddings</a><li><a href=https://storopoli.com/blog/word-embeddings/#julia-code>Julia Code</a><li><a href=https://storopoli.com/blog/word-embeddings/#conclusion>Conclusion</a></ul></div><section class=body><noscript><div class="admonition warning"><div class="admonition-icon admonition-icon-warning"></div><div class=admonition-content><strong class=admonition-title> Evil JavaScript </strong><p>This post uses <a href=https://katex.org/>KaTeX</a> to render mathematical expressions.<p>To see the rendered mathematical expressions, you’ll need to enable JavaScript.</div></div></noscript><p><img alt="Euclid of Alexandria" src=https://storopoli.com/blog/word-embeddings/euclid.jpg><p>I wish I could go back in time and tell my younger self that you can make a machine understand human language with trigonometry. That would definitely have made me more aware and interested in the subject during my school years. I would have looked at triangles, circles, sines, cosines, and tangents in a whole different way. Alas, better late than never.<p>In this post, we’ll learn how to represent words using word embeddings, and how to use basic trigonometry to play around with them. Of course, we’ll use <a href=https://julialang.org>Julia</a>.<h2 id=word-embeddings>Word Embeddings</h2><p><strong><a href=https://en.wikipedia.org/wiki/Word_embedding>Word embeddings</a> is a way to represent words as a real-valued vector that encodes the meaning of the word in such a way that words that are closer in the vector space are expected to be similar in meaning</strong>.<p>Ok, let’s unwrap the above definition. First, a <strong>real-valued vector</strong> is any vector which its elements belong to the real numbers. Generally we denote vectors with a bold lower-case letter, and we denote its elements (also called components) using square brackets. Hence, a vector $\bold{v}$ that has 3 elements, $1$, $2$, and $3$, can be written as<p>$$\bold{v} = \begin{bmatrix} 1 \\ 2 \\ 3 \end{bmatrix}$$<p>Next, what “close” means for vectors? We can use distance functions to get a measurable value. The most famous and commonly used distance function is the <strong>Euclidean distance</strong>, in honor of <a href=https://en.wikipedia.org/wiki/Euclid>Euclid</a>, the “father of geometry”, and the guy pictured in the image at the top of this post. The Euclidean distance is defined in trigonometry for 2-D and 3-D spaces. However, it can be generalized to any dimension $n > 1$ by using vectors.<p>Since every word is represented by an $n$-dimensional vector, we can use distances to compute a metric that represent similarity between vectors. And, more interesting, we can add and subtract words (or any other linear combination of one or more words) to generate new words.<p>Before we jump to code and examples, a quick note about how word embeddings are constructed. They are trained like a regular machine learning algorithm, where the cost function measures the difference between some vector distance between the vectors and a “semantic distance”. The goal is to iteratively find good vector values that minimize the cost. So, if a vector is close to another vector measured by a distance function, but far apart measured by some semantic distance on the words that these vectors represent, then the cost function will be higher. The algorithm cannot change the semantic distance, it is treated as a fixed value. However, it can change the vector elements’ values so that the vector distance function closely resembles the semantic distance function. Lastly, generally the dimensionality of the vectors used in word embeddings are high, $n > 50$, since it needs a proper amount of dimensions in order to represent all the semantic information of words with vectors.<h2 id=pre-trained-word-embeddings>Pre-Trained Word Embeddings</h2><p>Generally we don’t train our own word embeddings from scratch, we use pre-trained ones. Here is a list of some of the most popular ones:<ul><li><a href=https://code.google.com/archive/p/word2vec/>Word2Vec</a>: One of the first public available word embeddings, made by Google in 2013. Only supports English.<li><a href=https://nlp.stanford.edu/projects/glove/>GloVe</a>: made by Stanford in 2014. Only supports English.<li><a href=https://fasttext.cc/>FastText</a>: From Facebook, released in 2016. Supports hundreds of languages.</ul><h2 id=julia-code>Julia Code</h2><p>We will use the <a href=https://github.com/JuliaText/Embeddings.jl><code>Embeddings.jl</code></a> package to easily load word embeddings as vectors, and the <a href=https://github.com/JuliaStats/Distances.jl><code>Distances.jl</code></a> package for the convenience of several distance functions. This is a nice example of the Julia package ecosystem composability, where one package can define types, another can define functions, and another can define custom behavior of these functions on types that are defined in other packages.<pre class="language-julia z-code" data-lang=julia><code class=language-julia data-lang=julia><span class="z-source z-julia">julia<span class="z-keyword z-operator z-julia">></span> <span class="z-keyword z-other z-julia">using</span> Embeddings
</span><span class="z-source z-julia">
</span><span class="z-source z-julia">julia<span class="z-keyword z-operator z-julia">></span> <span class="z-keyword z-other z-julia">using</span> Distances
</span></code></pre><p>Let’s load the <a href=https://nlp.stanford.edu/projects/glove/>GloVe</a> word embeddings. First, let’s check what we have in store to choose from GloVe’s English language embeddings:<pre class="language-julia z-code" data-lang=julia><code class=language-julia data-lang=julia><span class="z-source z-julia">julia<span class="z-keyword z-operator z-julia">></span> language_files<span class="z-meta z-group z-julia"><span class="z-punctuation z-section z-group z-begin z-julia">(</span>GloVe{<span class="z-keyword z-operator z-colon z-julia"><span class="z-constant z-other z-symbol z-julia">:</span></span><span class="z-constant z-other z-symbol z-julia">en</span>}<span class="z-punctuation z-section z-group z-end z-julia">)</span></span>
</span><span class="z-source z-julia"><span class="z-constant z-numeric z-julia">20</span><span class="z-keyword z-operator z-julia">-</span>element Vector{String}<span class="z-keyword z-operator z-julia">:</span>
</span><span class="z-source z-julia"> <span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia"><span class="z-punctuation z-definition z-string z-begin z-julia">"</span></span></span><span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia">glove.6B/glove.6B.50d.txt<span class="z-punctuation z-definition z-string z-end z-julia">"</span></span></span>
</span><span class="z-source z-julia"> <span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia"><span class="z-punctuation z-definition z-string z-begin z-julia">"</span></span></span><span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia">glove.6B/glove.6B.100d.txt<span class="z-punctuation z-definition z-string z-end z-julia">"</span></span></span>
</span><span class="z-source z-julia"> <span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia"><span class="z-punctuation z-definition z-string z-begin z-julia">"</span></span></span><span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia">glove.6B/glove.6B.200d.txt<span class="z-punctuation z-definition z-string z-end z-julia">"</span></span></span>
</span><span class="z-source z-julia"> <span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia"><span class="z-punctuation z-definition z-string z-begin z-julia">"</span></span></span><span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia">glove.6B/glove.6B.300d.txt<span class="z-punctuation z-definition z-string z-end z-julia">"</span></span></span>
</span><span class="z-source z-julia"> <span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia"><span class="z-punctuation z-definition z-string z-begin z-julia">"</span></span></span><span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia">glove.42B.300d/glove.42B.300d.txt<span class="z-punctuation z-definition z-string z-end z-julia">"</span></span></span>
</span><span class="z-source z-julia"> <span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia"><span class="z-punctuation z-definition z-string z-begin z-julia">"</span></span></span><span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia">glove.840B.300d/glove.840B.300d.txt<span class="z-punctuation z-definition z-string z-end z-julia">"</span></span></span>
</span><span class="z-source z-julia"> <span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia"><span class="z-punctuation z-definition z-string z-begin z-julia">"</span></span></span><span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia">glove.twitter.27B/glove.twitter.27B.25d.txt<span class="z-punctuation z-definition z-string z-end z-julia">"</span></span></span>
</span><span class="z-source z-julia"> <span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia"><span class="z-punctuation z-definition z-string z-begin z-julia">"</span></span></span><span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia">glove.twitter.27B/glove.twitter.27B.50d.txt<span class="z-punctuation z-definition z-string z-end z-julia">"</span></span></span>
</span><span class="z-source z-julia"> <span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia"><span class="z-punctuation z-definition z-string z-begin z-julia">"</span></span></span><span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia">glove.twitter.27B/glove.twitter.27B.100d.txt<span class="z-punctuation z-definition z-string z-end z-julia">"</span></span></span>
</span><span class="z-source z-julia"> <span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia"><span class="z-punctuation z-definition z-string z-begin z-julia">"</span></span></span><span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia">glove.twitter.27B/glove.twitter.27B.200d.txt<span class="z-punctuation z-definition z-string z-end z-julia">"</span></span></span>
</span><span class="z-source z-julia"> <span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia"><span class="z-punctuation z-definition z-string z-begin z-julia">"</span></span></span><span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia">glove.6B/glove.6B.50d.txt<span class="z-punctuation z-definition z-string z-end z-julia">"</span></span></span>
</span><span class="z-source z-julia"> <span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia"><span class="z-punctuation z-definition z-string z-begin z-julia">"</span></span></span><span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia">glove.6B/glove.6B.100d.txt<span class="z-punctuation z-definition z-string z-end z-julia">"</span></span></span>
</span><span class="z-source z-julia"> <span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia"><span class="z-punctuation z-definition z-string z-begin z-julia">"</span></span></span><span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia">glove.6B/glove.6B.200d.txt<span class="z-punctuation z-definition z-string z-end z-julia">"</span></span></span>
</span><span class="z-source z-julia"> <span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia"><span class="z-punctuation z-definition z-string z-begin z-julia">"</span></span></span><span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia">glove.6B/glove.6B.300d.txt<span class="z-punctuation z-definition z-string z-end z-julia">"</span></span></span>
</span><span class="z-source z-julia"> <span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia"><span class="z-punctuation z-definition z-string z-begin z-julia">"</span></span></span><span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia">glove.42B.300d/glove.42B.300d.txt<span class="z-punctuation z-definition z-string z-end z-julia">"</span></span></span>
</span><span class="z-source z-julia"> <span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia"><span class="z-punctuation z-definition z-string z-begin z-julia">"</span></span></span><span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia">glove.840B.300d/glove.840B.300d.txt<span class="z-punctuation z-definition z-string z-end z-julia">"</span></span></span>
</span><span class="z-source z-julia"> <span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia"><span class="z-punctuation z-definition z-string z-begin z-julia">"</span></span></span><span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia">glove.twitter.27B/glove.twitter.27B.25d.txt<span class="z-punctuation z-definition z-string z-end z-julia">"</span></span></span>
</span><span class="z-source z-julia"> <span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia"><span class="z-punctuation z-definition z-string z-begin z-julia">"</span></span></span><span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia">glove.twitter.27B/glove.twitter.27B.50d.txt<span class="z-punctuation z-definition z-string z-end z-julia">"</span></span></span>
</span><span class="z-source z-julia"> <span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia"><span class="z-punctuation z-definition z-string z-begin z-julia">"</span></span></span><span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia">glove.twitter.27B/glove.twitter.27B.100d.txt<span class="z-punctuation z-definition z-string z-end z-julia">"</span></span></span>
</span><span class="z-source z-julia"> <span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia"><span class="z-punctuation z-definition z-string z-begin z-julia">"</span></span></span><span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia">glove.twitter.27B/glove.twitter.27B.200d.txt<span class="z-punctuation z-definition z-string z-end z-julia">"</span></span></span>
</span></code></pre><p>I’ll use the <code>"glove.6B/glove.6B.50d.txt"</code>. This means that it was trained with 6 billion tokens, and it provides embeddings with 50-dimensional vectors. The <code>load_embeddings</code> function takes an optional second positional argument as an <code>Int</code> to choose from which index of the <code>language_files</code> to use. Finally, I just want the words “king”, “queen”, “man”, “woman”; so I am passing these words as a <code>Set</code> to the <code>keep_words</code> keyword argument:<pre class="language-julia z-code" data-lang=julia><code class=language-julia data-lang=julia><span class="z-source z-julia">julia<span class="z-keyword z-operator z-julia">></span> <span class="z-keyword z-other z-julia">const</span> glove <span class="z-keyword z-operator z-assignment z-julia">=</span> load_embeddings<span class="z-meta z-group z-julia"><span class="z-punctuation z-section z-group z-begin z-julia">(</span>GloVe{<span class="z-keyword z-operator z-colon z-julia"><span class="z-constant z-other z-symbol z-julia">:</span></span><span class="z-constant z-other z-symbol z-julia">en</span>}, <span class="z-constant z-numeric z-julia">1</span>; keep_words<span class="z-keyword z-operator z-assignment z-julia">=</span>Set<span class="z-meta z-group z-julia"><span class="z-punctuation z-section z-group z-begin z-julia">(</span><span class="z-meta z-sequence z-julia"><span class="z-punctuation z-section z-sequence z-begin z-julia">[</span><span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia"><span class="z-punctuation z-definition z-string z-begin z-julia">"</span></span></span><span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia">king<span class="z-punctuation z-definition z-string z-end z-julia">"</span></span></span>, <span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia"><span class="z-punctuation z-definition z-string z-begin z-julia">"</span></span></span><span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia">queen<span class="z-punctuation z-definition z-string z-end z-julia">"</span></span></span>, <span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia"><span class="z-punctuation z-definition z-string z-begin z-julia">"</span></span></span><span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia">man<span class="z-punctuation z-definition z-string z-end z-julia">"</span></span></span>, <span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia"><span class="z-punctuation z-definition z-string z-begin z-julia">"</span></span></span><span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia">woman<span class="z-punctuation z-definition z-string z-end z-julia">"</span></span></span><span class="z-punctuation z-section z-sequence z-end z-julia">]</span></span><span class="z-punctuation z-section z-group z-end z-julia">)</span></span><span class="z-punctuation z-section z-group z-end z-julia">)</span></span>;
</span><span class="z-source z-julia">Embeddings.EmbeddingTable{Matrix{Float<span class="z-constant z-numeric z-julia">32</span>}, Vector{String}}<span class="z-meta z-group z-julia"><span class="z-punctuation z-section z-group z-begin z-julia">(</span>Float<span class="z-constant z-numeric z-julia">32</span><span class="z-meta z-sequence z-julia"><span class="z-punctuation z-section z-sequence z-begin z-julia">[</span><span class="z-keyword z-operator z-julia">-</span><span class="z-constant z-numeric z-julia">0.094386</span> <span class="z-constant z-numeric z-julia">0.50451</span> <span class="z-keyword z-operator z-julia">-</span><span class="z-constant z-numeric z-julia">0.18153</span> <span class="z-constant z-numeric z-julia">0.37854</span>; <span class="z-constant z-numeric z-julia">0.43007</span> <span class="z-constant z-numeric z-julia">0.68607</span> <span class="z-constant z-numeric z-julia">0.64827</span> <span class="z-constant z-numeric z-julia">1.8233</span>; … ; <span class="z-constant z-numeric z-julia">0.53135</span> <span class="z-keyword z-operator z-julia">-</span><span class="z-constant z-numeric z-julia">0.64426</span> <span class="z-constant z-numeric z-julia">0.48764</span> <span class="z-constant z-numeric z-julia">0.0092753</span>; <span class="z-keyword z-operator z-julia">-</span><span class="z-constant z-numeric z-julia">0.11725</span> <span class="z-keyword z-operator z-julia">-</span><span class="z-constant z-numeric z-julia">0.51042</span> <span class="z-keyword z-operator z-julia">-</span><span class="z-constant z-numeric z-julia">0.10467</span> <span class="z-keyword z-operator z-julia">-</span><span class="z-constant z-numeric z-julia">0.60284</span><span class="z-punctuation z-section z-sequence z-end z-julia">]</span></span>, <span class="z-meta z-sequence z-julia"><span class="z-punctuation z-section z-sequence z-begin z-julia">[</span><span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia"><span class="z-punctuation z-definition z-string z-begin z-julia">"</span></span></span><span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia">man<span class="z-punctuation z-definition z-string z-end z-julia">"</span></span></span>, <span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia"><span class="z-punctuation z-definition z-string z-begin z-julia">"</span></span></span><span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia">king<span class="z-punctuation z-definition z-string z-end z-julia">"</span></span></span>, <span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia"><span class="z-punctuation z-definition z-string z-begin z-julia">"</span></span></span><span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia">woman<span class="z-punctuation z-definition z-string z-end z-julia">"</span></span></span>, <span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia"><span class="z-punctuation z-definition z-string z-begin z-julia">"</span></span></span><span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia">queen<span class="z-punctuation z-definition z-string z-end z-julia">"</span></span></span><span class="z-punctuation z-section z-sequence z-end z-julia">]</span></span><span class="z-punctuation z-section z-group z-end z-julia">)</span></span>
</span></code></pre><p>Watch out with the order that we get back. If you see the output of <code>load_embeddings</code>, the order is <code>"man", "king", "woman", "queen"]</code> Let’s see how a word is represented:<pre class="language-julia z-code" data-lang=julia><code class=language-julia data-lang=julia><span class="z-source z-julia">julia<span class="z-keyword z-operator z-julia">></span> queen <span class="z-keyword z-operator z-assignment z-julia">=</span> glove.embeddings<span class="z-meta z-sequence z-julia"><span class="z-punctuation z-section z-sequence z-begin z-julia">[</span><span class="z-keyword z-operator z-julia">:</span>, <span class="z-constant z-numeric z-julia">4</span><span class="z-punctuation z-section z-sequence z-end z-julia">]</span></span>
</span><span class="z-source z-julia"><span class="z-constant z-numeric z-julia">50</span><span class="z-keyword z-operator z-julia">-</span>element Vector{Float<span class="z-constant z-numeric z-julia">32</span>}<span class="z-keyword z-operator z-julia">:</span>
</span><span class="z-source z-julia">  <span class="z-constant z-numeric z-julia">0.37854</span>
</span><span class="z-source z-julia">  <span class="z-constant z-numeric z-julia">1.8233</span>
</span><span class="z-source z-julia"> <span class="z-keyword z-operator z-julia">-</span><span class="z-constant z-numeric z-julia">1.2648</span>
</span><span class="z-source z-julia">  ⋮
</span><span class="z-source z-julia"> <span class="z-keyword z-operator z-julia">-</span><span class="z-constant z-numeric z-julia">2.2839</span>
</span><span class="z-source z-julia">  <span class="z-constant z-numeric z-julia">0.0092753</span>
</span><span class="z-source z-julia"> <span class="z-keyword z-operator z-julia">-</span><span class="z-constant z-numeric z-julia">0.60284</span>
</span></code></pre><p>They are 50-dimensional vectors of <code>Float32</code>.<p>Now, here’s the fun part: let’s add words and check the similarity between the result and some other word. A classical example is to start with the word “king”, subtract the word “men”, add the word “woman”, and check the distance of the result to the word “queen”:<pre class="language-julia z-code" data-lang=julia><code class=language-julia data-lang=julia><span class="z-source z-julia">julia<span class="z-keyword z-operator z-julia">></span> man <span class="z-keyword z-operator z-assignment z-julia">=</span> glove.embeddings<span class="z-meta z-sequence z-julia"><span class="z-punctuation z-section z-sequence z-begin z-julia">[</span><span class="z-keyword z-operator z-julia">:</span>, <span class="z-constant z-numeric z-julia">1</span><span class="z-punctuation z-section z-sequence z-end z-julia">]</span></span>;
</span><span class="z-source z-julia">
</span><span class="z-source z-julia">julia<span class="z-keyword z-operator z-julia">></span> king <span class="z-keyword z-operator z-assignment z-julia">=</span> glove.embeddings<span class="z-meta z-sequence z-julia"><span class="z-punctuation z-section z-sequence z-begin z-julia">[</span><span class="z-keyword z-operator z-julia">:</span>, <span class="z-constant z-numeric z-julia">2</span><span class="z-punctuation z-section z-sequence z-end z-julia">]</span></span>;
</span><span class="z-source z-julia">
</span><span class="z-source z-julia">julia<span class="z-keyword z-operator z-julia">></span> woman <span class="z-keyword z-operator z-assignment z-julia">=</span> glove.embeddings<span class="z-meta z-sequence z-julia"><span class="z-punctuation z-section z-sequence z-begin z-julia">[</span><span class="z-keyword z-operator z-julia">:</span>, <span class="z-constant z-numeric z-julia">3</span><span class="z-punctuation z-section z-sequence z-end z-julia">]</span></span>;
</span><span class="z-source z-julia">
</span><span class="z-source z-julia">julia<span class="z-keyword z-operator z-julia">></span> cosine_dist<span class="z-meta z-group z-julia"><span class="z-punctuation z-section z-group z-begin z-julia">(</span>king <span class="z-keyword z-operator z-julia">-</span> man <span class="z-keyword z-operator z-julia">+</span> woman, queen<span class="z-punctuation z-section z-group z-end z-julia">)</span></span>
</span><span class="z-source z-julia"><span class="z-constant z-numeric z-julia">0.13904202</span>f<span class="z-constant z-numeric z-julia">0</span>
</span></code></pre><p>This is less than 1/4 of the distance of “woman” to “king”:<pre class="language-julia z-code" data-lang=julia><code class=language-julia data-lang=julia><span class="z-source z-julia">julia<span class="z-keyword z-operator z-julia">></span> cosine_dist<span class="z-meta z-group z-julia"><span class="z-punctuation z-section z-group z-begin z-julia">(</span>woman, king<span class="z-punctuation z-section z-group z-end z-julia">)</span></span>
</span><span class="z-source z-julia"><span class="z-constant z-numeric z-julia">0.58866215</span>f<span class="z-constant z-numeric z-julia">0</span>
</span></code></pre><p>Feel free to play around with others words. If you want suggestions, another classical example is:<pre class="language-julia z-code" data-lang=julia><code class=language-julia data-lang=julia><span class="z-source z-julia">cosine_dist<span class="z-meta z-group z-julia"><span class="z-punctuation z-section z-group z-begin z-julia">(</span>Madrid <span class="z-keyword z-operator z-julia">-</span> Spain <span class="z-keyword z-operator z-julia">+</span> France, Paris<span class="z-punctuation z-section z-group z-end z-julia">)</span></span>
</span></code></pre><h2 id=conclusion>Conclusion</h2><p>I think that by allying interesting applications to abstract math topics like trigonometry is the vital missing piece in STEM education. I wish every new kid that is learning math could have the opportunity to contemplate how new and exciting technologies have some amazing simple math under the hood. If you liked this post, you would probably like <a href=https://en.wikipedia.org/wiki/Linear_algebra>linear algebra</a>. I would highly recommend <a href=https://math.mit.edu/~gs/>Gilbert Strang’s books</a> and <a href="https://www.youtube.com/playlist?list=PLZHQObOWTQDPD3MizzM2xVFitgF8hE_ab">3blue1brown series on linear algebra</a>.</section></article></main><div id=button-container><div id=toc-floating-container><input class=toggle id=toc-toggle type=checkbox><label class=overlay for=toc-toggle></label><label title="Toggle Table of Contents" class=button for=toc-toggle id=toc-button><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="M414.82-193.094q-18.044 0-30.497-12.32-12.453-12.319-12.453-30.036t12.453-30.086q12.453-12.37 30.497-12.37h392.767q17.237 0 29.927 12.487 12.69 12.486 12.69 30.203 0 17.716-12.69 29.919t-29.927 12.203H414.82Zm0-244.833q-18.044 0-30.497-12.487Q371.87-462.9 371.87-480.45t12.453-29.92q12.453-12.369 30.497-12.369h392.767q17.237 0 29.927 12.511 12.69 12.512 12.69 29.845 0 17.716-12.69 30.086-12.69 12.37-29.927 12.37H414.82Zm0-245.167q-18.044 0-30.497-12.32t-12.453-30.037q0-17.716 12.453-30.086 12.453-12.369 30.497-12.369h392.767q17.237 0 29.927 12.486 12.69 12.487 12.69 30.203 0 17.717-12.69 29.92-12.69 12.203-29.927 12.203H414.82ZM189.379-156.681q-32.652 0-55.878-22.829t-23.226-55.731q0-32.549 23.15-55.647 23.151-23.097 55.95-23.097 32.799 0 55.313 23.484 22.515 23.484 22.515 56.246 0 32.212-22.861 54.893-22.861 22.681-54.963 22.681Zm0-245.167q-32.652 0-55.878-23.134-23.226-23.135-23.226-55.623 0-32.487 23.467-55.517t56.12-23.03q32.102 0 54.721 23.288 22.62 23.288 22.62 55.775 0 32.488-22.861 55.364-22.861 22.877-54.963 22.877Zm-.82-244.833q-32.224 0-55.254-23.288-23.03-23.289-23.03-55.623 0-32.333 23.271-55.364 23.272-23.03 55.495-23.03 32.224 0 55.193 23.288 22.969 23.289 22.969 55.622 0 32.334-23.21 55.364-23.21 23.031-55.434 23.031Z"/></svg></label><div class=toc-content><div class=toc-container><ul><li><a href=https://storopoli.com/blog/word-embeddings/#word-embeddings>Word Embeddings</a><li><a href=https://storopoli.com/blog/word-embeddings/#pre-trained-word-embeddings>Pre-Trained Word Embeddings</a><li><a href=https://storopoli.com/blog/word-embeddings/#julia-code>Julia Code</a><li><a href=https://storopoli.com/blog/word-embeddings/#conclusion>Conclusion</a></ul></div></div></div><a title="Go to the top of the page" class=no-hover-padding href=# id=top-button> <svg viewbox="0 0 20 20" fill=currentColor><path d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z"/></svg> </a></div><link href=https://storopoli.com/katex.min.css rel=stylesheet><script defer src=https://storopoli.com/js/katex.min.js></script><span class=hidden id=copy-success> Copied! </span><span class=hidden id=copy-init> Copy code to clipboard </span><script defer src=https://storopoli.com/js/copyCodeToClipboard.min.js></script></div><footer><section><nav class="socials nav-navs"><ul><li><a class="nav-links no-hover-padding social" href=https://storopoli.com/atom.xml> <img alt=feed loading=lazy src=https://storopoli.com/social_icons/rss.svg title=feed> </a><li><a class="nav-links no-hover-padding social" rel=" me" href=mailto:jose@storopoli.com> <img alt=email loading=lazy src=https://storopoli.com/social_icons/email.svg title=email> </a><li><a class="nav-links no-hover-padding social" rel=" me" href=https://storopoli.com/publickey.txt> <img alt=pgp loading=lazy src=https://storopoli.com/social_icons/key.svg title=pgp> </a><li><a class="nav-links no-hover-padding social" rel=" me" href=https://github.com/storopoli/> <img alt=github loading=lazy src=https://storopoli.com/social_icons/github.svg title=github> </a><li><a class="nav-links no-hover-padding social" rel=" me" href=https://matrix.to/#/@jose:storopoli.com> <img alt=matrix loading=lazy src=https://storopoli.com/social_icons/matrix.svg title=matrix> </a><li><a class="nav-links no-hover-padding social" href="https://simplex.chat/contact#/?v=2-5&smp=smp%3A%2F%2FUkMFNAXLXeAAe0beCa4w6X_zp18PwxSaSjY17BKUGXQ%3D%40smp12.simplex.im%2FUXrwU_eqdgeHQ6HYehFs0s8VRHOr3k47%23%2F%3Fv%3D1-2%26dh%3DMCowBQYDK2VuAyEApVAYxmE0bpIIiPftNjehy4qOoa14ubyEGzbRX_BlO0w%253D%26srv%3Die42b5weq7zdkghocs3mgxdjeuycheeqqmksntj57rmejagmg4eor5yd.onion" rel=" me"> <img alt=simplex loading=lazy src=https://storopoli.com/social_icons/simplex.svg title=simplex> </a><li><a class="nav-links no-hover-padding social" rel=" me" href=https://orcid.org/0000-0002-0559-5176> <img alt=orcid loading=lazy src=https://storopoli.com/social_icons/orcid.svg title=orcid> </a></ul></nav><nav class=nav-navs></nav><div class=credits><small> Powered by <a href=https://www.getzola.org>Zola</a> & <a href=https://github.com/welpo/tabi>tabi</a> • <a href=https://github.com/storopoli/storopoli.com> Site source </a></small></div></section></footer>